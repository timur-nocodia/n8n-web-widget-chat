# ===================================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# ===================================================
# Copy this file to .env and update with your values
# SECURITY WARNING: Never commit .env files with real secrets!

# ===================================================
# DEPLOYMENT MODE - Choose one based on your needs
# ===================================================
# Options: stateless, sqlite, postgresql
DEPLOYMENT_MODE=stateless

# ===================================================
# SERVER CONFIGURATION
# ===================================================
API_HOST=0.0.0.0
API_PORT=8000
LOG_LEVEL=WARNING  # Production: WARNING or ERROR
DEBUG=false        # Always false in production

# ===================================================
# n8n INTEGRATION (REQUIRED)
# ===================================================
# Your n8n webhook URL for chat processing
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook/your-webhook-id/chat

# Optional: If your n8n webhook requires authentication
# N8N_API_KEY=your-n8n-api-key

# ===================================================
# SECURITY CONFIGURATION (REQUIRED)
# ===================================================
# Generate strong random keys (minimum 32 characters)
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=CHANGE_THIS_USE_OPENSSL_RAND_HEX_32_TO_GENERATE
SESSION_SECRET_KEY=CHANGE_THIS_USE_OPENSSL_RAND_HEX_32_TO_GENERATE

# JWT Configuration
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# ===================================================
# CORS CONFIGURATION (REQUIRED)
# ===================================================
# List all domains where your chat widget will be embedded
# Comma-separated, no trailing slashes
ALLOWED_ORIGINS=https://yourdomain.com,https://www.yourdomain.com

# Additional CORS settings
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=3600

# ===================================================
# RATE LIMITING
# ===================================================
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_PER_DAY=10000

# ===================================================
# SESSION CONFIGURATION
# ===================================================
SESSION_COOKIE_NAME=chat_session
SESSION_COOKIE_MAX_AGE=2592000  # 30 days in seconds
SESSION_COOKIE_SECURE=true      # Set to true if using HTTPS
SESSION_COOKIE_SAMESITE=lax
SESSION_COOKIE_HTTPONLY=true

# ===================================================
# DATABASE CONFIGURATION
# ===================================================
# Only needed if DEPLOYMENT_MODE=postgresql
# DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/chat_proxy
# REDIS_URL=redis://localhost:6379/0

# Only needed if DEPLOYMENT_MODE=sqlite
# SQLITE_DB_PATH=/var/lib/chat-proxy/chat_sessions.db
# SQLITE_CLEANUP_INTERVAL_HOURS=24
# SQLITE_SESSION_RETENTION_DAYS=30

# ===================================================
# PERFORMANCE TUNING
# ===================================================
# Number of worker processes (for production with uvicorn)
WORKERS=4

# Connection pool settings (PostgreSQL mode only)
# DB_POOL_SIZE=20
# DB_MAX_OVERFLOW=40
# DB_POOL_TIMEOUT=10

# ===================================================
# MONITORING & HEALTH
# ===================================================
# Enable metrics endpoint
ENABLE_METRICS=true
METRICS_PATH=/metrics

# Health check configuration
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INCLUDE_DETAILS=false  # Set false in production

# ===================================================
# STATIC FILE SERVING
# ===================================================
# Enable serving widget files from backend
SERVE_WIDGET_FILES=true
WIDGET_FILES_PATH=../chat-widget/dist

# ===================================================
# OPTIONAL: SENTRY ERROR TRACKING
# ===================================================
# SENTRY_DSN=https://your-key@sentry.io/project-id
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.1

# ===================================================
# OPTIONAL: SSL/TLS (if terminating SSL at app level)
# ===================================================
# SSL_CERT_FILE=/path/to/cert.pem
# SSL_KEY_FILE=/path/to/key.pem

# ===================================================
# OPTIONAL: PROXY CONFIGURATION
# ===================================================
# If behind a proxy/load balancer
# FORWARDED_ALLOW_IPS=*
# PROXY_HEADERS_TIMEOUT=5